<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <title>Simple Coin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
      .scrollbar-hide::-webkit-scrollbar {
        display: none;
      }
      .page {
        display: none;
      }
      .page.active {
        display: block;
      }
      button {
        cursor: pointer;
      }
    </style>
  </head>
  <body class="bg-white min-h-screen">
    <!-- Header -->
    <header class="bg-gray-50 shadow-md border-b border-gray-300">
      <div class="container mx-auto px-4 py-4">
        <div class="flex justify-between items-center">
          <h1
            class="text-3xl font-bold text-gray-800 flex items-center cursor-pointer"
            onclick="showPage('home')"
          >
            <span class="text-blue-600 mr-2">‚õìÔ∏è</span>
            Simple Coin
          </h1>

          <!-- Navigation -->
          <nav class="flex space-x-4">
            <button
              onclick="showPage('home')"
              class="nav-btn px-4 py-2 rounded-lg font-medium transition-colors"
              data-page="home"
            >
              Home
            </button>
            <button
              onclick="showPage('explorer')"
              class="nav-btn px-4 py-2 rounded-lg font-medium transition-colors"
              data-page="explorer"
            >
              Explorer
            </button>
            <button
              onclick="showPage('wallet')"
              class="nav-btn px-4 py-2 rounded-lg font-medium transition-colors"
              data-page="wallet"
            >
              Wallet
            </button>
          </nav>
        </div>
      </div>
    </header>

    <!-- Home Page -->
    <div id="homePage" class="page active">
      <div class="container mx-auto px-4 py-12">
        <div class="max-w-4xl mx-auto text-center">
          <!-- Hero Section -->
          <div class="mb-12">
            <h1 class="text-6xl font-bold text-gray-800 mb-6">
              <span class="text-blue-600">‚õìÔ∏è</span> Simple Coin
            </h1>
            <p class="text-xl text-gray-600 mb-8 leading-relaxed">
              A lightweight blockchain implementation built with TypeScript.<br />
              Experience the fundamentals of blockchain technology with an
              intuitive interface.
            </p>
          </div>

          <!-- Navigation Buttons - Moved Higher and More Prominent -->
          <div class="mb-12">
            <div class="flex flex-col sm:flex-row gap-6 justify-center mb-4">
              <button
                onclick="showPage('explorer')"
                class="group relative px-12 py-6 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-300 font-bold text-xl shadow-xl hover:shadow-2xl transform hover:scale-105"
              >
                <span class="flex items-center justify-center">
                  <span class="text-2xl mr-3">üîç</span>
                  Explore Blockchain
                </span>
                <div
                  class="absolute inset-0 bg-white opacity-0 group-hover:opacity-10 rounded-xl transition-opacity duration-300"
                ></div>
              </button>
              <button
                onclick="showPage('wallet')"
                class="group relative px-12 py-6 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-xl hover:from-green-700 hover:to-green-800 transition-all duration-300 font-bold text-xl shadow-xl hover:shadow-2xl transform hover:scale-105"
              >
                <span class="flex items-center justify-center">
                  <span class="text-2xl mr-3">üíº</span>
                  Open Wallet
                </span>
                <div
                  class="absolute inset-0 bg-white opacity-0 group-hover:opacity-10 rounded-xl transition-opacity duration-300"
                ></div>
              </button>
            </div>
            <p class="text-sm text-gray-500">
              Choose your action to get started with Simple Coin
            </p>
          </div>

          <!-- Features -->
          <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div
              class="bg-gray-50 rounded-xl p-6 shadow-md border border-gray-200 hover:shadow-lg hover:bg-gray-100 transition-all duration-300"
            >
              <div class="text-3xl mb-4">üîó</div>
              <h3 class="text-xl font-semibold text-gray-800 mb-2">
                Blockchain Explorer
              </h3>
              <p class="text-gray-600">
                Browse blocks, search by hash or index, and explore transaction
                details.
              </p>
            </div>

            <div
              class="bg-gray-50 rounded-xl p-6 shadow-md border border-gray-200 hover:shadow-lg hover:bg-gray-100 transition-all duration-300"
            >
              <div class="text-3xl mb-4">üí∞</div>
              <h3 class="text-xl font-semibold text-gray-800 mb-2">
                Digital Wallet
              </h3>
              <p class="text-gray-600">
                Manage your coins, check balance, and send transactions
                securely.
              </p>
            </div>

            <div
              class="bg-gray-50 rounded-xl p-6 shadow-md border border-gray-200 hover:shadow-lg hover:bg-gray-100 transition-all duration-300"
            >
              <div class="text-3xl mb-4">‚õèÔ∏è</div>
              <h3 class="text-xl font-semibold text-gray-800 mb-2">
                Mining System
              </h3>
              <p class="text-gray-600">
                Mine new blocks and earn rewards through proof-of-work
                consensus.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Explorer Page -->
    <div id="explorerPage" class="page">
      <div class="container mx-auto px-4 py-6">
        <!-- Explorer Content -->
        <div
          class="bg-gray-50 rounded-xl shadow-md border border-gray-200 mb-6"
        >
          <div class="p-6 border-b border-gray-200">
            <h2 class="text-2xl font-semibold text-gray-800 mb-6">
              üîó Blockchain Explorer
            </h2>

            <!-- Search Options -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <!-- Search by Index -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2"
                  >Search by Block Index</label
                >
                <div class="flex gap-2">
                  <input
                    type="number"
                    id="indexSearchInput"
                    placeholder="Enter block index (e.g., 0, 1, 2...)"
                    class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  />
                  <button
                    onclick="searchBlockByIndex()"
                    class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                  >
                    Search
                  </button>
                </div>
              </div>

              <!-- Search by Hash -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2"
                  >Search by Block Hash</label
                >
                <div class="flex gap-2">
                  <input
                    type="text"
                    id="hashSearchInput"
                    placeholder="Enter block hash..."
                    class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  />
                  <button
                    onclick="searchBlockByHash()"
                    class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors"
                  >
                    Search
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Blockchain Display -->
          <div class="p-6">
            <div
              id="explorerBlockchainContainer"
              class="space-y-4 max-h-96 overflow-y-auto scrollbar-hide"
            >
              <div class="text-center text-gray-500">
                <div
                  class="animate-spin rounded-full h-8 w-8 border-b-2 border-gray-600 mx-auto mb-2"
                ></div>
                Loading blockchain...
              </div>
            </div>
          </div>
        </div>

        <!-- Mempool & Mining Section -->
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
          <!-- Mempool -->
          <div
            class="lg:col-span-3 bg-gray-50 rounded-xl shadow-md border border-gray-200"
          >
            <div class="p-6 border-b border-gray-200">
              <h2 class="text-xl font-semibold text-gray-800">üìã Mempool</h2>
            </div>

            <div class="p-6">
              <div
                id="explorerMempoolContainer"
                class="space-y-3 max-h-48 overflow-y-auto scrollbar-hide"
              >
                <div class="text-center text-gray-500">
                  <div
                    class="animate-spin rounded-full h-6 w-6 border-b-2 border-gray-600 mx-auto mb-2"
                  ></div>
                  Loading mempool...
                </div>
              </div>
            </div>
          </div>

          <!-- Mining Controls -->
          <div class="bg-gray-50 rounded-xl shadow-md border border-gray-200">
            <div class="p-6 border-b border-gray-200">
              <h2 class="text-xl font-semibold text-gray-800">‚õèÔ∏è Mining</h2>
            </div>

            <div class="p-6 space-y-4">
              <button
                onclick="mineBlock()"
                id="explorerMineButton"
                class="w-full px-4 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors font-medium"
              >
                Mine Block
              </button>

              <div
                id="explorerMiningStatus"
                class="text-sm text-gray-600 text-center hidden"
              >
                <div
                  class="animate-spin rounded-full h-4 w-4 border-b-2 border-orange-600 mx-auto mb-1"
                ></div>
                Mining...
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Wallet Page -->
    <div id="walletPage" class="page">
      <div class="container mx-auto px-4 py-6">
        <!-- Wallet Content -->
        <div class="max-w-2xl mx-auto">
          <div
            class="bg-gray-50 rounded-xl shadow-md border border-gray-200 mb-6"
          >
            <div class="p-6 border-b border-gray-200">
              <h2 class="text-2xl font-semibold text-gray-800">üí∞ My Wallet</h2>
            </div>

            <div class="p-6 space-y-6">
              <!-- Balance Display -->
              <div
                class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-lg border border-green-200"
              >
                <div class="text-sm text-gray-600 mb-1">Current Balance</div>
                <div
                  id="walletPageBalance"
                  class="text-3xl font-bold text-green-600"
                >
                  <span class="animate-pulse">Loading...</span>
                </div>
              </div>

              <!-- Wallet Address -->
              <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                <div class="text-sm text-gray-600 mb-2">
                  Your Wallet Address
                </div>
                <div
                  id="walletPageAddress"
                  class="text-sm font-mono text-gray-800 break-all bg-white p-3 rounded border"
                >
                  Loading...
                </div>
              </div>

              <!-- Send Transaction -->
              <div class="space-y-4">
                <h3 class="text-lg font-semibold text-gray-800">Send Coins</h3>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2"
                    >Recipient Address</label
                  >
                  <input
                    type="text"
                    id="walletRecipientAddress"
                    placeholder="Enter recipient address..."
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  />
                </div>

                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2"
                    >Amount (SC)</label
                  >
                  <input
                    type="number"
                    id="walletSendAmount"
                    placeholder="0.00"
                    min="0"
                    step="0.01"
                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                  />
                </div>

                <button
                  onclick="sendTransactionFromWallet()"
                  class="w-full px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium text-lg"
                >
                  Send Transaction
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Mempool & Mining Section -->
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
          <!-- Mempool -->
          <div
            class="lg:col-span-3 bg-gray-50 rounded-xl shadow-md border border-gray-200"
          >
            <div class="p-6 border-b border-gray-200">
              <h2 class="text-xl font-semibold text-gray-800">üìã Mempool</h2>
            </div>

            <div class="p-6">
              <div
                id="walletMempoolContainer"
                class="space-y-3 max-h-48 overflow-y-auto scrollbar-hide"
              >
                <div class="text-center text-gray-500">
                  <div
                    class="animate-spin rounded-full h-6 w-6 border-b-2 border-gray-600 mx-auto mb-2"
                  ></div>
                  Loading mempool...
                </div>
              </div>
            </div>
          </div>

          <!-- Mining Controls -->
          <div class="bg-gray-50 rounded-xl shadow-md border border-gray-200">
            <div class="p-6 border-b border-gray-200">
              <h2 class="text-xl font-semibold text-gray-800">‚õèÔ∏è Mining</h2>
            </div>

            <div class="p-6 space-y-4">
              <button
                onclick="mineBlock()"
                id="walletMineButton"
                class="w-full px-4 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors font-medium"
              >
                Mine Block
              </button>

              <div
                id="walletMiningStatus"
                class="text-sm text-gray-600 text-center hidden"
              >
                <div
                  class="animate-spin rounded-full h-4 w-4 border-b-2 border-orange-600 mx-auto mb-1"
                ></div>
                Mining...
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      let blockchain = [];
      let mempool = [];
      let walletBalance = 0;
      let walletAddress = "";
      let currentPage = "home";

      // API Base URL
      const API_BASE = window.location.origin;

      // Page navigation with URL routing
      function showPage(pageName, updateHistory = true) {
        // Hide all pages
        document.querySelectorAll(".page").forEach((page) => {
          page.classList.remove("active");
        });

        // Show selected page
        document.getElementById(pageName + "Page").classList.add("active");

        // Update navigation buttons
        document.querySelectorAll(".nav-btn").forEach((btn) => {
          btn.classList.remove("bg-gray-200", "text-gray-800", "font-semibold");
          btn.classList.add(
            "text-gray-600",
            "hover:text-gray-800",
            "hover:bg-gray-100"
          );
        });

        const activeBtn = document.querySelector(`[data-page="${pageName}"]`);
        if (activeBtn) {
          activeBtn.classList.remove(
            "text-gray-600",
            "hover:text-gray-800",
            "hover:bg-gray-100"
          );
          activeBtn.classList.add(
            "bg-gray-200",
            "text-gray-800",
            "font-semibold"
          );
        }

        currentPage = pageName;

        // Update URL
        if (updateHistory) {
          const url = pageName === "home" ? "/" : `/${pageName}`;
          window.history.pushState({ page: pageName }, "", url);
        }

        // Update page title
        const titles = {
          home: "Simple Coin",
          explorer: "Simple Coin - Explorer",
          wallet: "Simple Coin - Wallet",
        };
        document.title = titles[pageName] || "Simple Coin";

        // Load data for the specific page
        if (pageName === "explorer") {
          loadExplorerData();
        } else if (pageName === "wallet") {
          loadWalletData();
        }
      }

      // Handle browser back/forward buttons
      function handlePopState(event) {
        const page = event.state ? event.state.page : getPageFromURL();
        showPage(page, false);
      }

      // Get page from current URL
      function getPageFromURL() {
        const path = window.location.pathname;
        if (path === "/") return "home";
        if (path === "/explorer") return "explorer";
        if (path === "/wallet") return "wallet";
        return "home"; // default
      }

      // Initialize the application
      async function init() {
        await loadWalletInfo();

        // Set up popstate event listener for browser back/forward buttons
        window.addEventListener("popstate", handlePopState);

        // Show the correct page based on current URL
        const initialPage = getPageFromURL();
        showPage(initialPage, false);

        // Set up auto-refresh for current page
        setInterval(async () => {
          await loadWalletInfo();
          if (currentPage === "explorer") {
            await loadExplorerData();
          } else if (currentPage === "wallet") {
            await loadWalletData();
          }
        }, 5000);
      }

      // Load wallet information
      async function loadWalletInfo() {
        try {
          const [balanceRes, addressRes] = await Promise.all([
            fetch(`${API_BASE}/balance`),
            fetch(`${API_BASE}/address`),
          ]);

          const balanceData = await balanceRes.json();
          const addressData = await addressRes.json();

          walletBalance = balanceData.balance;
          walletAddress = addressData.address;
        } catch (error) {
          console.error("Error loading wallet info:", error);
          showToast("Error loading wallet information", "error");
        }
      }

      // Load explorer data
      async function loadExplorerData() {
        await loadBlockchain();
        await loadMempool("explorer");
      }

      // Load wallet data
      async function loadWalletData() {
        // Update wallet display
        document.getElementById(
          "walletPageBalance"
        ).textContent = `${walletBalance.toFixed(2)} SC`;
        document.getElementById("walletPageAddress").textContent =
          walletAddress;
        await loadMempool("wallet");
      }

      // Load blockchain
      async function loadBlockchain() {
        try {
          const response = await fetch(`${API_BASE}/blocks`);
          blockchain = await response.json();
          displayBlockchain();
        } catch (error) {
          console.error("Error loading blockchain:", error);
          showToast("Error loading blockchain", "error");
        }
      }

      // Display blockchain
      function displayBlockchain() {
        const container = document.getElementById(
          "explorerBlockchainContainer"
        );

        if (blockchain.length === 0) {
          container.innerHTML =
            '<div class="text-center text-gray-500">No blocks found</div>';
          return;
        }

        container.innerHTML = blockchain
          .map(
            (block) => `
          <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
            <div class="flex justify-between items-start mb-3">
              <div>
                <div class="text-lg font-semibold text-gray-800">Block #${
                  block.index
                }</div>
                <div class="text-sm text-gray-500">
                  ${new Date(block.timestamp * 1000).toLocaleString()}
                </div>
              </div>
              <div class="text-right">
                <div class="text-sm text-gray-600">Difficulty: ${
                  block.difficulty
                }</div>
                <div class="text-sm text-gray-600">Nonce: ${block.nonce}</div>
              </div>
            </div>
            
            <div class="space-y-2">
              <div>
                <span class="text-sm font-medium text-gray-700">Hash:</span>
                <div class="text-xs font-mono text-blue-600 break-all">${
                  block.hash
                }</div>
              </div>
              
              <div>
                <span class="text-sm font-medium text-gray-700">Previous Hash:</span>
                <div class="text-xs font-mono text-gray-600 break-all">${
                  block.previousHash || "Genesis Block"
                }</div>
              </div>
              
              <div>
                <span class="text-sm font-medium text-gray-700">Transactions: ${
                  block.data.length
                }</span>
                ${
                  block.data.length > 0
                    ? `
                  <div class="mt-3 space-y-3">
                    ${block.data
                      .map(
                        (tx) => `
                      <div class="bg-gray-50 p-3 rounded border">
                        <div class="mb-2">
                          <span class="text-xs font-medium text-gray-700">Transaction ID:</span>
                          <div class="text-xs font-mono text-blue-600 break-all">${
                            tx.id
                          }</div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                          <!-- Inputs -->
                          <div>
                            <div class="text-xs font-medium text-gray-700 mb-1">Inputs (${
                              tx.txIns.length
                            }):</div>
                            <div class="space-y-1">
                              ${tx.txIns
                                .map(
                                  (txIn) => `
                                <div class="text-xs bg-white p-2 rounded border">
                                  <div class="text-gray-600">
                                    <span class="font-medium">TxOut ID:</span> 
                                    ${
                                      txIn.txOutId
                                        ? txIn.txOutId.substring(0, 16) + "..."
                                        : "Coinbase"
                                    }
                                  </div>
                                  <div class="text-gray-600">
                                    <span class="font-medium">Index:</span> ${
                                      txIn.txOutIndex
                                    }
                                  </div>
                                  ${
                                    txIn.signature
                                      ? `
                                    <div class="text-gray-600">
                                      <span class="font-medium">Signature:</span> ${txIn.signature.substring(
                                        0,
                                        20
                                      )}...
                                    </div>
                                  `
                                      : ""
                                  }
                                </div>
                              `
                                )
                                .join("")}
                            </div>
                          </div>
                          
                          <!-- Outputs -->
                          <div>
                            <div class="text-xs font-medium text-gray-700 mb-1">Outputs (${
                              tx.txOuts.length
                            }):</div>
                            <div class="space-y-1">
                              ${tx.txOuts
                                .map(
                                  (txOut, index) => `
                                <div class="text-xs bg-white p-2 rounded border">
                                  <div class="text-gray-600">
                                    <span class="font-medium">Index:</span> ${index}
                                  </div>
                                  <div class="text-gray-600">
                                    <span class="font-medium">Address:</span> 
                                    <div class="font-mono text-green-600 break-all">${txOut.address.substring(
                                      0,
                                      20
                                    )}...</div>
                                  </div>
                                  <div class="text-gray-600">
                                    <span class="font-medium">Amount:</span> 
                                    <span class="font-bold text-green-600">${
                                      txOut.amount
                                    } SC</span>
                                  </div>
                                </div>
                              `
                                )
                                .join("")}
                            </div>
                          </div>
                        </div>
                        
                        <div class="mt-2 pt-2 border-t border-gray-200">
                          <div class="text-xs text-gray-500">
                            <span class="font-medium">Total Output:</span> 
                            <span class="font-bold text-green-600">${tx.txOuts.reduce(
                              (sum, out) => sum + out.amount,
                              0
                            )} SC</span>
                          </div>
                        </div>
                      </div>
                    `
                      )
                      .join("")}
                  </div>
                `
                    : ""
                }
              </div>
            </div>
          </div>
        `
          )
          .join("");
      }

      // Search block by index
      async function searchBlockByIndex() {
        const index = parseInt(
          document.getElementById("indexSearchInput").value
        );
        if (isNaN(index)) {
          showToast("Please enter a valid block index", "warning");
          return;
        }

        try {
          const response = await fetch(`${API_BASE}/block/index/${index}`);
          const block = await response.json();

          if (block) {
            highlightBlock(block);
            showToast("Block found!", "success");
          } else {
            showToast("Block not found", "warning");
          }
        } catch (error) {
          console.error("Error searching block:", error);
          showToast("Error searching block", "error");
        }
      }

      // Search block by hash
      async function searchBlockByHash() {
        const hash = document.getElementById("hashSearchInput").value.trim();
        if (!hash) {
          showToast("Please enter a block hash", "warning");
          return;
        }

        try {
          const response = await fetch(`${API_BASE}/block/hash/${hash}`);
          const block = await response.json();

          if (block) {
            highlightBlock(block);
            showToast("Block found!", "success");
          } else {
            showToast("Block not found", "warning");
          }
        } catch (error) {
          console.error("Error searching block:", error);
          showToast("Error searching block", "error");
        }
      }

      // Highlight found block
      function highlightBlock(block) {
        const container = document.getElementById(
          "explorerBlockchainContainer"
        );
        const blockElements = container.children;

        // Remove existing highlights
        for (let i = 0; i < blockElements.length; i++) {
          blockElements[i].classList.remove("ring-2", "ring-blue-500");
        }

        // Find and highlight the matching block
        const blockIndex = blockchain.findIndex(
          (b) => b.hash === block.hash || b.index === block.index
        );
        if (blockIndex !== -1 && blockElements[blockIndex]) {
          blockElements[blockIndex].classList.add("ring-2", "ring-blue-500");
          blockElements[blockIndex].scrollIntoView({
            behavior: "smooth",
            block: "center",
          });
        }
      }

      // Load mempool
      async function loadMempool(page) {
        try {
          const response = await fetch(`${API_BASE}/mempool`);
          mempool = await response.json();
          displayMempool(page);
        } catch (error) {
          console.error("Error loading mempool:", error);
        }
      }

      // Display mempool
      function displayMempool(page) {
        const containerId =
          page === "explorer"
            ? "explorerMempoolContainer"
            : "walletMempoolContainer";
        const container = document.getElementById(containerId);

        if (mempool.length === 0) {
          container.innerHTML =
            '<div class="text-center text-gray-500">Mempool is empty</div>';
          return;
        }

        container.innerHTML = mempool
          .map(
            (tx) => `
          <div class="border border-orange-200 bg-orange-50 rounded-lg p-3">
            <div class="mb-3">
              <div class="text-sm font-medium text-gray-800 mb-1">Pending Transaction</div>
              <div class="text-xs font-mono text-blue-600 break-all">${
                tx.id
              }</div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
              <!-- Inputs -->
              <div>
                <div class="text-xs font-medium text-gray-700 mb-1">Inputs (${
                  tx.txIns.length
                }):</div>
                <div class="space-y-1">
                  ${tx.txIns
                    .map(
                      (txIn) => `
                    <div class="text-xs bg-white p-2 rounded border">
                      <div class="text-gray-600">
                        <span class="font-medium">TxOut ID:</span> 
                        ${
                          txIn.txOutId
                            ? txIn.txOutId.substring(0, 16) + "..."
                            : "Coinbase"
                        }
                      </div>
                      <div class="text-gray-600">
                        <span class="font-medium">Index:</span> ${
                          txIn.txOutIndex
                        }
                      </div>
                      ${
                        txIn.signature
                          ? `
                        <div class="text-gray-600">
                          <span class="font-medium">Signature:</span> ${txIn.signature.substring(
                            0,
                            20
                          )}...
                        </div>
                      `
                          : ""
                      }
                    </div>
                  `
                    )
                    .join("")}
                </div>
              </div>
              
              <!-- Outputs -->
              <div>
                <div class="text-xs font-medium text-gray-700 mb-1">Outputs (${
                  tx.txOuts.length
                }):</div>
                <div class="space-y-1">
                  ${tx.txOuts
                    .map(
                      (txOut, index) => `
                    <div class="text-xs bg-white p-2 rounded border">
                      <div class="text-gray-600">
                        <span class="font-medium">Index:</span> ${index}
                      </div>
                      <div class="text-gray-600">
                        <span class="font-medium">Address:</span> 
                        <div class="font-mono text-green-600 break-all">${txOut.address.substring(
                          0,
                          20
                        )}...</div>
                      </div>
                      <div class="text-gray-600">
                        <span class="font-medium">Amount:</span> 
                        <span class="font-bold text-green-600">${
                          txOut.amount
                        } SC</span>
                      </div>
                    </div>
                  `
                    )
                    .join("")}
                </div>
              </div>
            </div>
            
            <div class="mt-3 pt-2 border-t border-orange-200">
              <div class="flex justify-between items-center">
                <div class="text-xs text-gray-600">
                  <span class="font-medium">Status:</span> 
                  <span class="text-orange-600 font-medium">‚è≥ Waiting for mining</span>
                </div>
                <div class="text-xs text-gray-600">
                  <span class="font-medium">Total Output:</span> 
                  <span class="font-bold text-green-600">${tx.txOuts
                    .reduce((sum, out) => sum + out.amount, 0)
                    .toFixed(2)} SC</span>
                </div>
              </div>
            </div>
          </div>
        `
          )
          .join("");
      }

      // Send transaction from wallet page
      async function sendTransactionFromWallet() {
        const address = document
          .getElementById("walletRecipientAddress")
          .value.trim();
        const amount = parseFloat(
          document.getElementById("walletSendAmount").value
        );

        if (!address || !amount || amount <= 0) {
          showToast(
            "Please enter valid recipient address and amount",
            "warning"
          );
          return;
        }

        if (amount > walletBalance) {
          showToast("Insufficient balance", "error");
          return;
        }

        try {
          const response = await fetch(`${API_BASE}/sendTransaction`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              address: address,
              amount: amount,
            }),
          });

          if (response.ok) {
            const result = await response.json();
            showToast("Transaction sent successfully!", "success");

            // Clear form
            document.getElementById("walletRecipientAddress").value = "";
            document.getElementById("walletSendAmount").value = "";

            // Refresh data
            await loadWalletInfo();
            await loadWalletData();
          } else {
            const error = await response.text();
            showToast(`Transaction failed: ${error}`, "error");
          }
        } catch (error) {
          console.error("Error sending transaction:", error);
          showToast("Error sending transaction", "error");
        }
      }

      // Mine block
      async function mineBlock() {
        const buttonId =
          currentPage === "explorer"
            ? "explorerMineButton"
            : "walletMineButton";
        const statusId =
          currentPage === "explorer"
            ? "explorerMiningStatus"
            : "walletMiningStatus";

        const button = document.getElementById(buttonId);
        const status = document.getElementById(statusId);

        button.disabled = true;
        button.textContent = "Mining...";
        status.classList.remove("hidden");

        try {
          const response = await fetch(`${API_BASE}/mineBlock`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
          });

          if (response.ok) {
            const result = await response.json();
            showToast(`Block #${result.index} mined successfully!`, "success");

            // Refresh all data
            await loadWalletInfo();
            if (currentPage === "explorer") {
              await loadExplorerData();
            } else if (currentPage === "wallet") {
              await loadWalletData();
            }
          } else {
            const error = await response.text();
            showToast(`Mining failed: ${error}`, "error");
          }
        } catch (error) {
          console.error("Error mining block:", error);
          showToast("Error mining block", "error");
        } finally {
          button.disabled = false;
          button.textContent = "Mine Block";
          status.classList.add("hidden");
        }
      }

      // Show alert notification
      function showToast(message, type = "info") {
        const icons = {
          success: "‚úÖ",
          error: "‚ùå",
          warning: "‚ö†Ô∏è",
          info: "‚ÑπÔ∏è",
        };

        const icon = icons[type] || icons.info;
        alert(`${icon} ${message}`);
      }

      // Handle Enter key in search inputs
      document.addEventListener("DOMContentLoaded", function () {
        document
          .getElementById("indexSearchInput")
          .addEventListener("keypress", function (e) {
            if (e.key === "Enter") {
              searchBlockByIndex();
            }
          });

        document
          .getElementById("hashSearchInput")
          .addEventListener("keypress", function (e) {
            if (e.key === "Enter") {
              searchBlockByHash();
            }
          });
      });

      // Initialize the application when DOM is loaded
      document.addEventListener("DOMContentLoaded", init);
    </script>
  </body>
</html>
